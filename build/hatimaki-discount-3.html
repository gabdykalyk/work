<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Добавление кампании</title>
    
    <!-- <link href="bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet"> -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link href="fonts/fontawesome/css/all.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.4/css/select2.min.css" rel="stylesheet" />
<link href="css/main.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

</head>

<body>
    <nav class="navbar navbar-fixed-top navbar-lk">
    <div class="container-fluid">
        <div class="navbar-collapse collapse" id="navbar-collapse-block">
            <ul class="nav navbar-nav navbar-nav-main">
                <li class="item-menu-manper"><a href="#">Личное дело<span class="count">1</span></a></li>
                <li class="item-menu-messages"><a href="#">Сообщения<span class="count">5</span></a></li>
                <li class="item-menu-alerts"><a href="#">Оповещения<span class="count">2</span></a></li>
                <li class="item-menu-schedule"><a href="#">График работы</a></li>
                <li class="item-menu-index"><a href="#">Ключевые показатели<span class="count">3</span></a></li>
                <li class="item-menu-docs"><a href="#">Инструкции и приказы<span class="count">1</span></a></li>
                <li class="item-menu-discus"><a href="#">Обсуждения<span class="count">4</span></a></li>
                <li class="item-menu-complaints"><a href="#">Жалобы и предложения<span class="count">1</span></a>
                </li>
                <li class="item-menu-friends"><a href="#">Друзья</a></li>
                <li class="item-menu-groups"><a href="#">Группы</a></li>
                <li class="item-menu-settings"><a href="#">Настройки</a></li>
                <li class="item-menu-help"><a href="#">Помощь</a></li>
            </ul>
        </div>
        <button type="button" class="navbar-toggle collapsed" id="navbar-toggle">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <i class="fa fa-chevron-left" aria-hidden="true"></i>
        </button>
        <div class="navbar-right navbar-login">
            <a href="#" class="btn"><span>Александр Константиновский</span> <i
                    class="fa fa-sign-out hidden-sm hidden-xs" aria-hidden="true"></i></a>
        </div>
        <ul class="nav navbar-nav navbar-right navbar-nav-social">
            <li><a href="#" title="Вконтакте"><i class="fab fa-vk"></i></a></li>
            <li><a href="#" title="Есть непросмотренные сообщения"><i class="fa fa-envelope"
                        aria-hidden="true"></i><span class="badge"></span></a></li>
            <li class="item-bell" title="Есть непросмотренные уведомления"><a tabindex="0" role="button"
                    data-toggle="popover" data-placement="bottom" data-trigger="click" title="Dismissible popover"
                    id="notice"><i class="fa fa-bell" aria-hidden="true"></i><span class="badge"></span></a></li>
        </ul>
    </div>
</nav>
<!-- popover content: notice -->
<div id="popover-content-notice" style="display: none;">
    <ul class="notice-list scrollbar-inner">
        <li>
            <p>28.04.2019 собрание для операторов, водителей, тех. сотрудников и администраторов филиалов
                Бутово, Щербинка, Эталон, Коммунарка</p>
        </li>
        <li>
            <p>28.04.2019 собрание для операторов, водителей, тех. сотрудников и администраторов филиалов
                Бутово, Щербинка, Эталон, Коммунарка</p>
            <div class="file">
                <a class="file__block" href="#">
                    <div class="file__img" style="background-image: url(images/img1.jpg);"></div>
                </a>
                <a class="file__block" href="#">
                    <div class="file__file" style="color: #337AB7;"><i class="far fa-file-word"></i></div>
                </a>
            </div>
        </li>
        <li>
            <div class="file">
                <a class="file__block" href="#">
                    <div class="file__file" style="color: #337AB7;"><i class="far fa-file-word"></i></div>
                </a>
            </div>
        </li>
        <li>
            <p>28.04.2019 собрание для операторов, водителей, тех. сотрудников и администраторов филиалов
                Бутово, Щербинка, Эталон, Коммунарка</p>
        </li>
        <li>
            <p>28.04.2019 собрание для операторов, водителей, тех. сотрудников и администраторов филиалов
                Бутово, Щербинка, Эталон, Коммунарка</p>
            <div class="file">
                <a class="file__block" href="#">
                    <div class="file__img" style="background-image: url(images/img1.jpg);"></div>
                </a>
                <a class="file__block" href="#">
                    <div class="file__file" style="color: #337AB7;"><i class="far fa-file-word"></i></div>
                </a>
                <a class="file__block" href="#">
                    <div class="file__img" style="background-image: url(images/img1.jpg);"></div>
                </a>
                <a class="file__block" href="#">
                    <div class="file__file" style="color: #337AB7;"><i class="far fa-file-word"></i></div>
                </a>
            </div>
        </li>
        <li>
            <div class="file">
                <a class="file__block" href="#">
                    <div class="file__file" style="color: #337AB7;"><i class="far fa-file-word"></i></div>
                </a>
            </div>
        </li>
        <li>
            <p>28.04.2019 собрание для операторов, водителей, тех. сотрудников и администраторов филиалов
                Бутово, Щербинка, Эталон, Коммунарка</p>
        </li>
        <li>
            <p>28.04.2019 собрание для операторов, водителей, тех. сотрудников и администраторов филиалов
                Бутово, Щербинка, Эталон, Коммунарка</p>
            <div class="file">
                <a class="file__block" href="#">
                    <div class="file__img" style="background-image: url(images/img1.jpg);"></div>
                </a>
                <a class="file__block" href="#">
                    <div class="file__file" style="color: #337AB7;"><i class="far fa-file-word"></i></div>
                </a>
            </div>
        </li>
        <li>
            <div class="file">
                <a class="file__block" href="#">
                    <div class="file__file" style="color: #337AB7;"><i class="far fa-file-word"></i></div>
                </a>
            </div>
        </li>
    </ul>
</div>

    <div class="container-fluid content discount">

        <h1>
            Добавление кампании
        </h1>
        <hr class="hr-margin hr-xs-100 hidden-xs">
		<div class="btn-group" role="group">
			<a href="#" type="button" class="btn btn-default">Основные настройки</a>
			<a href="#" type="button" class="btn btn-default">Свойства</a>
			<a href="#" type="button" class="btn btn-default active">Действия</a>
		</div>
		<form class="form-respons discount__acts js-discount-form" action="" method="post">
			<div class="row">
				<div class="col-lg-4 col-md-4 col-sm-6 form-group">
                    <label for="act_type">Тип действия</label>
                    <select class="form-control js-select2 js-act-type" name="act-type[]" id="act-type" multiple="" tabindex="-1" aria-hidden="true">
                        <option value="disc" selected="">Скидка</option>
                        <option value="fixprice" selected="">Фикс. цена</option>
                        <option value="gift" selected="">Подарок</option>
                    </select>
				</div>
				<div class="clearfix"></div>
				<div class="js-disc-block">
					<div class="col-sm-12">
						<h4>Скидка</h4>
					</div>
					<div class="col-lg-3 col-md-3 col-sm-4 form-group">
						<label for="disc-what">На что скидка</label>
						<select class="form-control js-select-placeholder js-disc-what" name="disc-what" id="disc-what">
							<option value="for-order">На заказ</option>
							<option value="for-item" selected="">На товар</option>
						</select>
					</div>
					<div class="clearfix"></div>
					<div class="js-disc-row">
						<div class="col-lg-3 col-md-3 col-sm-4 col-xs-8 form-group">
							<label class="hidden-xs" for="disc-category">Категория</label>
							<select class="form-control js-select2 js-placeholder-category" name="disc-category[]" id="disc-category[]" multiple="multiple" tabindex="-1" aria-hidden="true">
								<option></option>
								<option value="1">Суши</option>
								<option value="2">Роллы</option>
								<option value="3">Сеты</option>
							</select>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-5 col-xs-8 form-group">
							<label class="hidden-xs" for="disc-name">Наименование</label>
							<select class="form-control js-select2 js-placeholder-name" name="disc-name[]" id="disc-name" multiple="multiple" tabindex="-1" aria-hidden="true">
								<option></option>
								<option value="1">Товар 1</option>
								<option value="2">Товар 2</option>
								<option value="3">Товар 3</option>
							</select>
						</div>
					</div>
					<div class="clearfix"></div>
					<div class="col-lg-3 col-md-3 col-sm-4 col-xs-6 form-group">
						<label>Размер скидки</label>
						<div class="discount__flex js-disc-type">
							<input class="form-control disc-type-input js-active" type="text" name="disc-rub" id="disc-rub" /> 
							<label class="black-label" for="disc-rub"><i class="fas fa-ruble-sign"></i></label>
							<input class="form-control disc-type-input no-active js-no-active" type="text" name="percent" id="percent" />
							<label class="black-label" for="percent">%</label>
						</div>
					</div>
				</div>
				<div class="clearfix"></div>
				<div class="js-fixprice-block">
					<div class="col-sm-12">
						<h4>Фиксированная цена</h4>
					</div>
					<div class="js-fixprice-row fixprice-row">
						<div class="col-lg-3 col-md-3 col-sm-4 col-xs-8 form-group">
							<label class="hidden-xs" for="fixprice-category">Категория</label>
							<select class="form-control js-select2 js-placeholder-category" name="fixprice-category" id="fixprice-category">
								<option></option>
								<option value="1">Суши</option>
								<option value="2">Роллы</option>
								<option value="3">Сеты</option>
							</select>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-5 col-xs-8 form-group">
							<label class="hidden-xs" for="fixprice-name">Наименование</label>
							<select class="form-control js-select2 js-placeholder-name" name="fixprice-name" id="fixprice-name">
								<option></option>
								<option value="1">Чай Витаминный</option>
								<option value="2">Молочный Улун</option>
								<option value="3">Товар 3</option>
							</select>
						</div>
						<div class="clearfix visible-xs"></div>
						<div class="col-lg-2 col-md-2 col-sm-2 col-xs-3 form-group form-group-discount">
							<label>Цена</label>
							<div class="discount__flex">
								<input class="form-control" type="text" name="fixprice-rub" id="fixprice-rub" /> 
								<label class="black-label" for="fixprice-rub"><i class="fas fa-ruble-sign"></i></label>
							</div>
						</div>
						<div class="col-lg-3 col-md-3 col-sm-1 col-offset-xs-5 col-xs-4 form-group fixprice-btn-block no-label">
							<button type="button" class="btn btn-danger btn-remove-row jsRemove" title="Удалить" style="display: none;"><i class="fa fa-times" aria-hidden="true"></i></button>
							<button type="button" class="btn btn-success btn-add-row jsAddNew" title="Добавить"><i class="fa fa-plus" aria-hidden="true"></i></button>
						</div>
					</div>
				</div>
				<div class="clearfix"></div>
				<div class="js-gift-block gift-block">
					<div class="col-sm-12">
						<h4>Подарок</h4>
					</div>
					<div class="js-gift-row">
						<div class="col-lg-3 col-md-3 col-sm-4 col-xs-8 form-group">
							<label class="hidden-xs" for="gift-category">Категория</label>
							<select class="form-control js-select2 js-placeholder-category" name="gift-category" id="gift-category">
								<option></option>
								<option value="1">Суши</option>
								<option value="2">Роллы</option>
								<option value="3">Сеты</option>
							</select>
						</div>
						<div class="col-lg-4 col-md-4 col-sm-5 col-xs-8 form-group">
							<label class="hidden-xs" for="gift-name">Наименование</label>
							<select class="form-control js-select2 js-placeholder-name" name="gift-name" id="gift-name">
								<option></option>
								<option value="1">Товар 1</option>
								<option value="2">Товар 2</option>
								<option value="3">Товар 3</option>
							</select>
						</div>
						<div class="col-lg-5 col-md-5 col-sm-3 col-xs-4 form-group gift-btn-block no-label">
							<button type="button" class="btn btn-danger btn-remove-row jsRemove" title="Удалить" style="display: none;"><i class="fa fa-times" aria-hidden="true"></i></button>
							<button type="button" class="btn btn-success btn-add-row jsAddNew" title="Добавить"><i class="fa fa-plus" aria-hidden="true"></i></button>
						</div>
					</div>
				</div>
				<div class="clearfix"></div>
				<div class="col-lg-9 col-md-9 col-sm-12 discount__right-btn">
					<button class="btn btn-default btn-p25" type="submit">Вернуться</button>
					<button class="btn btn-primary btn-p25" type="submit">Сохранить</button>
				</div>
			</div>
		</form>
    </div>
	
    <script id="fixpriceRowTemplate" type="text/template">
		<div class="js-fixprice-row fixprice-row" style="display:none;">
			<div class="col-lg-3 col-md-3 col-sm-4 col-xs-8 form-group">
				<label class="hidden-xs" for="fixprice-category">Категория</label>
				<select class="form-control js-select2 js-placeholder-category" name="fixprice-category" id="fixprice-category">
					<option></option>
					<option value="1">Суши</option>
					<option value="2">Роллы</option>
					<option value="3">Сеты</option>
				</select>
			</div>
			<div class="col-lg-4 col-md-4 col-sm-5 col-xs-8 form-group">
				<label class="hidden-xs" for="fixprice-name">Наименование</label>
				<select class="form-control js-select2 js-placeholder-name" name="fixprice-name" id="fixprice-name">
					<option></option>
					<option value="1">Чай Витаминный</option>
					<option value="2">Молочный Улун</option>
					<option value="3">Товар 3</option>
				</select>
			</div>
			<div class="clearfix visible-xs"></div>
			<div class="col-lg-2 col-md-2 col-sm-2 col-xs-3 form-group form-group-discount">
				<label>Цена</label>
				<div class="discount__flex">
					<input class="form-control" type="text" name="fixprice-rub" id="fixprice-rub" /> 
					<label class="black-label" for="fixprice-rub"><i class="fas fa-ruble-sign"></i></label>
				</div>
			</div>
			<div class="col-lg-3 col-md-3 col-sm-1 col-offset-xs-5 col-xs-4 form-group fixprice-btn-block no-label">
				<button type="button" class="btn btn-danger btn-remove-row jsRemove" title="Удалить" style="display: none;"><i class="fa fa-times" aria-hidden="true"></i></button>
				<button type="button" class="btn btn-success btn-add-row jsAddNew" title="Добавить"><i class="fa fa-plus" aria-hidden="true"></i></button>
			</div>
		</div>
	</script>
	
    <script id="giftRowTemplate" type="text/template">
    	<div class="js-gift-row" style="display: none;">
			<div class="col-lg-3 col-md-3 col-sm-4 col-xs-8 form-group">
				<label class="hidden-xs" for="gift-category">Категория</label>
				<select class="form-control js-select2 js-placeholder-category" name="gift-category" id="gift-category">
					<option></option>
					<option value="1">Суши</option>
					<option value="2">Роллы</option>
					<option value="3">Сеты</option>
				</select>
			</div>
			<div class="col-lg-4 col-md-4 col-sm-5 col-xs-8 form-group">
				<label class="hidden-xs" for="gift-name">Наименование</label>
				<select class="form-control js-select2 js-placeholder-name" name="gift-name" id="gift-name">
					<option></option>
					<option value="1">Товар 1</option>
					<option value="2">Товар 2</option>
					<option value="3">Товар 3</option>
				</select>
			</div>
			<div class="col-lg-5 col-md-5 col-sm-3 col-xs-4 form-group gift-btn-block no-label">
				<button type="button" class="btn btn-danger btn-remove-row jsRemove" title="Удалить" style="display: none;"><i class="fa fa-times" aria-hidden="true"></i></button>
				<button type="button" class="btn btn-success btn-add-row jsAddNew" title="Добавить"><i class="fa fa-plus" aria-hidden="true"></i></button>
			</div>
		</div>
	</script>

	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
</script>

<!-- Bootstrap DateTimepicker, https://eonasdan.github.io/bootstrap-datetimepicker/ -->
<script type="text/javascript" src="js/moment-with-locales.min.js"></script>
<script type="text/javascript" src="js/bootstrap-datetimepicker.min.js"></script>

<!-- Select2, https://select2.org/getting-started/basic-usage -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.4/js/select2.full.min.js"></script>

<!-- Custom Scroll, http://gromo.github.io/jquery.scrollbar/-->
<script src="js/jquery.scrollbar.min.js"></script>

<script type="text/javascript" src="js/js-gl.js"></script>
    
    <script type="text/javascript">
        $(function() {
        	initNavbar();

            $('.js-select2').select2({
                width: '100%'
            });
            
            var placeholderSelect2 = (function(select, placeholder) {
				return $(select).select2({
					width: '100%',
					placeholder: placeholder,
				});
            });
            
	        var placeholdersOnXS = (function() {
	        	var winWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
				if (winWidth < 768) {
					placeholderSelect2('.js-placeholder-category', 'Категория');
					placeholderSelect2('.js-placeholder-name', 'Наименование');
				} else {
					placeholderSelect2('.js-placeholder-category', ' ');
					placeholderSelect2('.js-placeholder-name', ' ');
				}
	        });
	        
	        $(window).on('load resize', function() {
				placeholdersOnXS();
			});
			
			$(document).on('change', '.js-act-type', function (e) {
				var select = $(document).find('.js-act-type'),
                    now = select.val(),
                    block = select.closest('.js-discount-form'),
                    disc = block.find('.js-disc-block'),
                    fixprice = block.find('.js-fixprice-block'),
                    gift = block.find('.js-gift-block');
                    
                showOrHideBlock(disc, 'disc', now);
                showOrHideBlock(fixprice, 'fixprice', now);
                showOrHideBlock(gift, 'gift', now);
			});
			
            $(document).on('change', '.js-disc-what', function() {
                var select = $(document).find('.js-disc-what'),
                    now = select.val(),
                    block = select.closest('.js-disc-block'),
                    item = block.find('.js-disc-row');
                
                if (now === 'for-item') {
                    item.show();
                } else {
                    item.hide();
                }
            });

            $(document).on('click', '.disc-type-input', function() {
                var parent = $(this).closest('.js-disc-type'),
                	inputs = parent.find('input');
                if (!$(this).hasClass('js-active')) {
	                inputs.val('');
	                inputs.toggleClass('js-no-active').toggleClass('no-active').toggleClass('js-active');	
                }
            });
            
            var editFixprice = (function() {
                var me = {};
                me.blockEdit = $('.js-fixprice-block');
                me.init = function() {
                    me.blockEdit.on('click', '.jsAddNew', me.addNewItem);
                    me.blockEdit.on('click', '.jsRemove', me.removeItem);
                }
                me.addNewItem = function() {
                    var parent = $(this).closest('.js-fixprice-block'),
                        rowTemplate = $('#fixpriceRowTemplate'),
                        row = parent.find('.js-fixprice-row'),
                        addBtn = row.find('.jsAddNew'),
                        allDelBtn, newRow;
                        
                    if (!rowTemplate) return false;
                    rowTemplate = $(rowTemplate.html());
                    rowTemplate.appendTo(parent);
                    addBtn.hide();
                    
					allDelBtn = parent.find('.jsRemove');
					allDelBtn.show();
					newRow = parent.find('.js-fixprice-row:last-child');
                    newRow.fadeIn(500);
                    
                    placeholdersOnXS();
                }
                me.removeItem = function() {
                    var parent = $(this).closest('.js-fixprice-block'),
                    	row = $(this).closest('.js-fixprice-row'),
                    	rowLastChild = parent.find('.js-fixprice-row:last-child'),
                    	lastRow, addBtn, delBtn;
                    
                    if (row.index() === rowLastChild.index()) {
                    	lastRow_index = row.index() - 2; // стоит -2, а не -1, т.к. в начале есть блок с заголовком
			        	lastRow = $(this).closest('.js-fixprice-block').find('.js-fixprice-row:eq(' + lastRow_index + ')');
			        } else {
			        	lastRow = rowLastChild;
			        }
			        
					addBtn = lastRow.find('.jsAddNew');
                	addBtn.show();
                	
					row.fadeOut(500, function() {
						row.remove();
					});
					
					if (rowLastChild.index() === 2) {
						delBtn = parent.find('.jsRemove');
						delBtn.hide();
					}
                }
                return me;
            }());
            
            var editGift = (function() {
                var me = {};
                me.blockEdit = $('.js-gift-block');
                me.init = function() {
                    me.blockEdit.on('click', '.jsAddNew', me.addNewItem);
                    me.blockEdit.on('click', '.jsRemove', me.removeItem);
                }
                me.addNewItem = function() {
                    var parent = $(this).closest('.js-gift-block'),
                        rowTemplate = $('#giftRowTemplate'),
                        row = parent.find('.js-gift-row'),
                        addBtn = row.find('.jsAddNew'),
                        allDelBtn, newRow;
                        
                    if (!rowTemplate) return false;
                    rowTemplate = $(rowTemplate.html());
                    rowTemplate.appendTo(parent);
                    addBtn.hide();
                    
					allDelBtn = parent.find('.jsRemove');
					allDelBtn.show();
					newRow = parent.find('.js-gift-row:last-child');
                    newRow.fadeIn(500);
                    
                    placeholdersOnXS();
                }
                me.removeItem = function() {
                    var parent = $(this).closest('.js-gift-block'),
                    	row = $(this).closest('.js-gift-row'),
                    	rowLastChild = parent.find('.js-gift-row:last-child'),
                    	lastRow, addBtn, delBtn;
                    
                    if (row.index() === rowLastChild.index()) {
                    	lastRow_index = row.index() - 2; // стоит -2, а не -1, т.к. в начале есть блок с заголовком
			        	lastRow = $(this).closest('.js-gift-block').find('.js-gift-row:eq(' + lastRow_index + ')');
			        } else {
			        	lastRow = rowLastChild;
			        }
			        
					addBtn = lastRow.find('.jsAddNew');
                	addBtn.show();
                	
					row.fadeOut(500, function() {
						row.remove();
					});
					
					if (rowLastChild.index() === 2) {
						delBtn = parent.find('.jsRemove');
						delBtn.hide();
					}
                }
                return me;
            }());

            // если на странице есть нужный селектор, запускать функцию
            document.querySelector('.js-fixprice-block') && editFixprice.init();
            document.querySelector('.js-gift-block') && editGift.init();
            

        });
		
    </script>

</body>

</html>