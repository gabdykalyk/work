<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Создать тип документа</title>
    <!-- Bootstrap -->
    <link href="bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Icons -->
    <link href="fonts/fontawesome/css/all.css" rel="stylesheet">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700" rel="stylesheet">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.4/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css" />

    <link href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/13.1.3/nouislider.css" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>

<body>
    <nav class="navbar navbar-fixed-top navbar-lk">
        <div class="container-fluid">
            <div class="navbar-collapse collapse" id="navbar-collapse-block">
                <ul class="nav navbar-nav navbar-nav-main">
                    <li class="item-menu-manper active"><a href="#">Расчёты<span class="count">1</span></a></li>
                    <li class="item-menu-messages"><a href="#">Новый расчёт<span class="count">5</span></a></li>
                    <li class="item-menu-alerts"><a href="#">Штрафы/Премии<span class="count">2</span></a></li>
                    <li class="item-menu-schedule"><a href="#">Приказы/Инструкции</a></li>
                    <li class="item-menu-index"><a href="#">Кадры<span class="count">3</span></a></li>
                    <li class="item-menu-docs"><a href="#">Отчёты<span class="count">1</span></a></li>
                    <li class="item-menu-discus"><a href="#">Обсуждения<span class="count">4</span></a></li>
                    <li class="item-menu-complaints"><a href="#">Жалобы и предложения<span class="count">1</span></a></li>
                    <li class="item-menu-friends"><a href="#">Друзья</a></li>
                    <li class="item-menu-groups"><a href="#">Группы</a></li>
                    <li class="item-menu-settings"><a href="#">Настройки</a></li>
                    <li class="item-menu-help"><a href="#">Помощь</a></li>
                </ul>
            </div>
            <button type="button" class="navbar-toggle collapsed" id="navbar-toggle">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <i class="fa fa-chevron-left" aria-hidden="true"></i>
            </button>
            <div class="navbar-right navbar-login">
                <a href="#" class="btn"><span>Александр Константиновский</span> <i class="fa fa-sign-out hidden-sm hidden-xs" aria-hidden="true"></i></a>
            </div>
            <ul class="nav navbar-nav navbar-right navbar-nav-social">
                <li><a href="#" title="Вконтакте"><i class="fab fa-vk" aria-hidden="true"></i></a></li>
                <li><a href="#" title="Есть непросмотренные сообщения"><i class="fa fa-envelope" aria-hidden="true"></i><span class="badge"></span></a></li>
                <li class="item-bell" title="Есть непросмотренные уведомления"><a href="#"><i class="fa fa-bell" aria-hidden="true"></i><span class="badge"></span></a></li>
            </ul>
        </div>
    </nav>

    <div class="container-fluid content">
        <h1>
            Создать тип документа
        </h1>
        <hr class="hr-margin hr-xs-100 hidden-xs">
        
        <form class="doctype-form" action="" method="post">
        	<div class="row">
                <div class="col-xs-12 form-group">
					<label for="name">Название</label>
					<input type="text" class="form-control" value="" name="name" id="name">
				</div>
                <div class="col-sm-6 col-xs-12 form-group">
					<label for="post">Должности</label>
					<select class="form-control js-select-multiple js-select-post" name="post[]" id="post" multiple="multiple" tabindex="-1" aria-hidden="true">
						<option></option>
						<option value="1">Администратор филиал</option>
						<option value="2">Директор IT</option>
						<option value="3">Водитель</option>
					</select>
				</div>
                <div class="col-sm-6 col-xs-12 form-group">
					<label for="nationality">Гражданство</label>
					<select class="form-control js-select-multiple js-select-nationality" name="nationality[]" id="nationality" multiple="multiple" tabindex="-1" aria-hidden="true">
						<option value="1">Россия</option>
						<option value="2">Украина</option>
						<option value="3">Белоруссия</option>
					</select>
				</div>
                <div class="col-xs-12 form-group form-group-chbxs">
					<div class="checkbox">
                        <label>
                            <input type="checkbox" id="required-doc"> Обязательный документ
                        </label>
                    </div>
				</div>
			</div>

	        <div class="table-doctype-block">
	            <div class="table-responsive">
                    <table class="table table-hover table-doctype">
                        <thead>
                            <tr>
                                <th class="cell-head">
                                    <div class="cell-head_name">Ответственный</div>
                                </th>
                                <th class="cell-head">
                                    <div class="cell-head_name">Филиал</div>
                                </th>
                                <th class="cell-head">
                                    <div class="cell-head_name">Типы нотификаций</div>
                                </th>
                                <th class="cell-head-btns">
                                    <button type="button" class="btn btn-xs btn-default btn-add-row jsAddNewItem" title="Добавить"><i class="fa fa-plus" aria-hidden="true"></i></button>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td data-label="Ответственный" class="cell-info">
			                        <select class="form-control" name="responsible_1">
			                            <option value="admin_butovo">admin_butovo</option>
			                            <option value="admin_yuzhnaya">admin_yuzhnaya</option>
			                        </select>
                                </td>
                                <td data-label="Филиал" class="cell-info">
	                                <select class="form-control js-select-branch" name="branch[]" multiple="" tabindex="-1" aria-hidden="true">
				                        <option value="1">Щербинка</option>
				                        <option value="2">Бутово</option>
				                        <option value="3">Ясенево</option>
				                        <option value="4">Коммунарка</option>
				                        <option value="5">Подольск</option>
				                        <option value="6">Московский</option>
				                    </select>
                                </td>
                                <td data-label="Типы нотификаций" class="cell-info">
                                	<div class="form-group form-group-chbxs">
										<div class="checkbox">
					                        <label>
					                            <input type="checkbox"> Email
					                        </label>
					                    </div>
										<div class="checkbox">
					                        <label>
					                            <input type="checkbox"> SMS
					                        </label>
					                    </div>
				                	</div>
                                </td>
                                <td class="cell-btn">
                                	<button type="button" class="btn btn-xs btn-danger btn-remove-row jsRemoveItem" title="Удалить"><i class="fa fa-minus" aria-hidden="true"></i></button>
                                    <button type="button" class="btn btn-xs btn-default btn-add-row jsAddNewItem" title="Добавить"><i class="fa fa-plus" aria-hidden="true"></i></button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
	            </div>
	        </div>
			<div class="form-group form-btns">
				<a href="#" class="btn btn-default" type="button">Вернуться</a>
				<a href="#" class="btn btn-primary" type="button">Сохранить</a>
			</div>
        </form>
    </div>
    <script id="rowTemplate" type="text/template">
        <tr class="added-row" style="display:none;">
            <td data-label="Ответственный" class="cell-info">
                <select class="form-control" name="responsible">
                    <option value="admin_butovo">admin_butovo</option>
                    <option value="admin_yuzhnaya">admin_yuzhnaya</option>
                </select>
            </td>
            <td data-label="Филиал" class="cell-info">
                <select class="form-control js-select-branch" name="branch[]" multiple="" tabindex="-1" aria-hidden="true">
                    <option value="1">Щербинка</option>
                    <option value="2">Бутово</option>
                    <option value="3">Ясенево</option>
                    <option value="4">Коммунарка</option>
                    <option value="5">Подольск</option>
                    <option value="6">Московский</option>
                </select>
            </td>
            <td data-label="Типы нотификаций" class="cell-info">
            	<div class="form-group form-group-chbxs">
					<div class="checkbox">
                        <label>
                            <input type="checkbox"> Email
                        </label>
                    </div>
					<div class="checkbox">
                        <label>
                            <input type="checkbox"> SMS
                        </label>
                    </div>
            	</div>
            </td>
            <td class="cell-btn">
            	<button type="button" class="btn btn-xs btn-danger btn-remove-row jsRemoveItem" title="Удалить"><i class="fa fa-minus" aria-hidden="true"></i></button>
                <button type="button" class="btn btn-xs btn-default btn-add-row jsAddNewItem" title="Добавить"><i class="fa fa-plus" aria-hidden="true"></i></button>
            </td>
        </tr>
	</script>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="bootstrap-3.3.7/js/bootstrap.min.js"></script>

    <!-- Bootstrap DateTimepicker, https://eonasdan.github.io/bootstrap-datetimepicker/ -->
    <script type="text/javascript" src="js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="js/bootstrap-datetimepicker.min.js"></script>

    <!-- Select2, https://select2.org/getting-started/basic-usage -->
    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.4/js/select2.min.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.4/js/select2.full.min.js"></script>

    <script type="text/javascript" src="js/js-gl.js"></script>
    <!-- noUiSlider https://refreshless.com/nouislider/download/ -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/13.1.3/nouislider.min.js"></script>
    <script type="text/javascript">
        $(function() {

            $('.js-select-multiple').select2({
                width: '100%'
            });

            $('.js-select-post').select2({
                width: '100%',
                placeholder: 'Выберите должности',
            });

            $('.js-select-nationality').select2({
                width: '100%',
                placeholder: 'Выберите гражданство',
            });
            
            $('.js-select-branch').select2({
                width: '100%',
                placeholder: 'Выберите филиал',
            });

            // изменение высоты ячеек в таблице для моб. версии (w < 768px)
            $(window).on('load resize', function() {
                var winWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
                if (winWidth < 768) {
                    changeHeightCellMobile($('.table-fired'));
                } else {
                    var reserHeight = $('.js-cell-mobile');
                    $(reserHeight).removeAttr('style');
                }

            });
            $('.table-fired-block').on('click', '.toogleLoader', function() {
                var winWidth = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
                if (winWidth < 768) {
                    $('.table-fired tfoot').toggle();
                }
            });

            var editDocs = (function() {
                var me = {};
                me.formEditDocs = $('.doctype-form');
                me.init = function() {
                    // для добавления нового item на страницу
                    me.formEditDocs.on('click', '.jsAddNewItem', me.addNewItem);
                    // для удаления item
                    me.formEditDocs.on('click', '.jsRemoveItem', me.removeItem);
                }
                me.addNewItem = function() {
                    var table = $(this).closest('table'),
                        itemTemplate = table.data('itemTemplate') || 'rowTemplate',
                        rowTemplate = $('#' + itemTemplate),
                        tbody = table.find('> tbody'),
                        tr = tbody.find('tr'),
                        addBtn = tr.find('.jsAddNewItem');

                    if (!rowTemplate) return false;

                    rowTemplate = $(rowTemplate.html());
                    var inputs = rowTemplate.find('input');

                    var input;
                    for (var i = 0; i < inputs.length; i++) {
                        input = $(inputs[i]);
                        if (input.hasClass('numbersOnly')) {
                            input.inputFilter(me.numbersOnly);
                        }
                    }

                    rowTemplate.appendTo(tbody);
                    addBtn.hide();
                    var newTr = tbody.find('tr:last-child');
                    newTr.fadeIn(500);
                    $('.js-select-branch').select2({
		                width: '100%',
		                placeholder: 'Выберите филиал',
		            });
                }
                me.removeItem = function() {
                    var tr = $(this).closest('tr'),
                    	trLastChild = $(this).closest('table').find('> tbody > tr:last-child'),
                    	lastTr, addBtn;
                    if (tr.index() == trLastChild.index()) {
                    	var lastTr_index = tr.index() - 1;
			        	lastTr = $(this).closest('table').find('> tbody > tr:eq(' + lastTr_index + ')');
			        } else {
			        	lastTr = trLastChild;
			        }
					addBtn = lastTr.find('.jsAddNewItem');
					
                	addBtn.show();
					tr.fadeOut(500, function() {
			            tr.remove();
			        });
                }
                return me;
            }());

            // если на странице есть нужный селектор, запускать фукнцию editBonuses.init
            document.querySelector('.doctype-form') && editDocs.init();


        });
    </script>

</body>

</html>