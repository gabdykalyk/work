<!DOCTYPE html>
<html class="hrm-page calculation-page hrm-page--initializing"
      data-bind="childrenComplete: childrenComplete"
      lang="ru">

<head>
  @@include('../../base/_page-head-content.html')
</head>

<body>
  <div style="display: none">
    <svg>
      <symbol id="excel-icon">
        <path d="M8.47538 3.125H10.5823L8.05679 6.85381L10.9062 11H8.71957L6.98437 8.43767L5.24813 11H3.0625L5.91196 6.85381L3.38642 3.125H5.49336L6.98437 5.29456L8.47538 3.125Z"
              fill="#12C971" />
        <path d="M1 13V1H13V13H1Z"
              stroke="#12C971"
              fill="none"
              stroke-width="2" />
      </symbol>
      <symbol id="print-icon">
        <path d="M4 5V1H10.0625V5"
              stroke="#8E9CBB"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              fill="none" />
        <path d="M3.4 11H2.2C1.88174 11 1.57652 10.8595 1.35147 10.6095C1.12643 10.3594 1 10.0203 1 9.66667V6.33333C1 5.97971 1.12643 5.64057 1.35147 5.39052C1.57652 5.14048 1.88174 5 2.2 5H11.8C12.1183 5 12.4235 5.14048 12.6485 5.39052C12.8736 5.64057 13 5.97971 13 6.33333V9.66667C13 10.0203 12.8736 10.3594 12.6485 10.6095C12.4235 10.8595 12.1183 11 11.8 11H10.6"
              stroke="#8E9CBB"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              fill="none" />
        <path d="M10 9H4V13H10V9Z"
              stroke="#8E9CBB"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              fill="none" />
      </symbol>
      <symbol id="picture-icon">
        <path d="M11.6667 1H2.33333C1.59695 1 1 1.59695 1 2.33333V11.6667C1 12.403 1.59695 13 2.33333 13H11.6667C12.403 13 13 12.403 13 11.6667V2.33333C13 1.59695 12.403 1 11.6667 1Z"
              stroke="#8E9CBB"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              fill="none" />
        <path d="M5.5 6C6.32843 6 7 5.32843 7 4.5C7 3.67157 6.32843 3 5.5 3C4.67157 3 4 3.67157 4 4.5C4 5.32843 4.67157 6 5.5 6Z"
              fill="#8E9CBB" />
        <path d="M13 9.18182L10.1875 6L4 13"
              stroke="#8E9CBB"
              stroke-width="2"
              stroke-linejoin="round"
              fill="none" />
        <path d="M6 9.81818L4.4375 8L1 12"
              stroke="#8E9CBB"
              stroke-width="2"
              stroke-linejoin="round"
              fill="none" />
      </symbol>
      <symbol id="calculation-icon">
        <path d="M4 5H10M4 8H6M4 11H6M8 8H10M8 11H10M3 15H11C12.1046 15 13 14.1046 13 13V3C13 1.89543 12.1046 1 11 1H3C1.89543 1 1 1.89543 1 3V13C1 14.1046 1.89543 15 3 15Z"
              stroke="#8E9CBB"
              stroke-width="2"
              fill="none" />
      </symbol>
    </svg>
  </div>
  <div class="hrm-scaffold">
    <div class="hrm-scaffold__sidebar"
         data-bind="component: {name: 'hrm-main-sidebar', params: {collapsed: isSidebarCollapsed}}"></div>
    <div class="hrm-scaffold__body">
      <!-- Page content  -->
      <div class="hrm-scaffold__content calculation-page__content">

        <div class="calculation-page__header">
          <span class="calculation-page__title">
            <!-- ko text: isNew() ? 'Новый расчет' : 'Сохраненный расчет' -->
            <!-- /ko -->
          </span>
          <div class="calculation-page__actions">
            <!-- ko ifnot: isNew -->

            <!-- ko if: $root.utils.viewportSize().width > HRM_BREAKPOINTS.mobileMaxWidth -->
            <button class="hrm-button hrm-button-with-icon-right hrm-button-with-arrow-down-icon-right hrm-button-with-icon--theme_secondary calculation-tab__settings-button calculation-tab__settings-employees"
                    data-bind="hrmDropdownMenu, hrmDropdownMenuTemplate: 'versions-dropdown-template'">
              <!-- ko if: currentVersion -->
              <!-- ko text: currentVersion().time -->
              <!-- /ko -->
              <!-- /ko -->
            </button>

            <button class="hrm-button hrm-button-with-icon-right hrm-button-with-arrow-down-icon-right hrm-button-with-icon--theme_secondary calculation-tab__settings-button calculation-tab__settings-employees"
                    data-bind="hrmDropdownMenu, hrmDropdownMenuTemplate: 'actions-dropdown-template'">
              Действия
            </button>
            <!-- /ko -->

            <button class="hrm-button hrm-circle-icon-button hrm-circle-bookmark-icon-button"
              data-bind="hrmTooltip,
              hrmTooltipText: inBookmarks()
                ? 'Удалить раздел из избранного'
                : 'Добавить в избранное',
              click: function() {
                if (inBookmarks()) removeFromBookmarks();
                else addToBookmarks();
              },
              css: {
                'active': inBookmarks
              }">
            </button>
            <!-- /ko -->

            <a href="#"
               class="hrm-button hrm-button-with-icon hrm-button-with-icon--hide_tablet hrm-button-with-icon--theme_secondary hrm-button-with-arrow-left-icon">
              К списку расчетов
            </a>

          </div>
        </div>

        <!-- ko if: !isNew() && $root.utils.viewportSize().width <= HRM_BREAKPOINTS.mobileMaxWidth -->
        <div class="calculation-page__actions">
          <button class="hrm-button hrm-button-with-icon-right hrm-button-with-arrow-down-icon-right hrm-button-with-icon--theme_secondary calculation-tab__settings-button calculation-tab__settings-employees"
                  data-bind="hrmDropdownMenu, hrmDropdownMenuTemplate: 'versions-dropdown-template'">
            <!-- ko if: currentVersion -->
            <!-- ko text: currentVersion.time() -->
            <!-- /ko -->
            <!-- /ko -->
          </button>

          <button class="hrm-button hrm-button-with-icon-right hrm-button-with-arrow-down-icon-right hrm-button-with-icon--theme_secondary calculation-tab__settings-button calculation-tab__settings-employees"
                  data-bind="hrmDropdownMenu, hrmDropdownMenuTemplate: 'actions-dropdown-template'">
            Действия
          </button>
        </div>
        <!-- /ko -->

        <div class="calculation-form">
          <!-- Input table -->
          <div
               data-bind="component: {name: 'calculation-page-input-form', params: { model: $root.inputModel, onSubmit: $root.buildCalculation.bind($root) }}">
          </div>
          <!-- /Input table -->

          <!-- ko template: {
            foreach: hrmTemplateIf(loading(), $data),
            afterAdd: hrmFadeAfterAddFactory(200, 200),
          } -->
          <div class="loader-block">
            <i class="fa fa-spinner fa-pulse loader-block__indicator">
            </i>
            <span class="loader-block__text">Производится расчет</span>
          </div>
          <!-- /ko -->

          <!-- ko template: {
            foreach: hrmTemplateIf(!loading() && isBuilt(), $data),
            afterAdd: afterRenderBuild,
            beforeRemove: hrmFadeBeforeRemoveFactory(200)
          } -->
          <div class="calculation-form__content">
            <!-- Summary table -->
            <div data-bind="component: {name: 'calculation-page-summary-table', params: { model: $root.summaryModel }}">
            </div>
            <!-- /Summary table -->

            <!-- Tabs -->
            <div class="calculation-page__tabs"
                 data-bind="component: {name: 'hrm-tab-group', params: {items: tabs.tabs, activeItem: tabs.activeTab }}">
            </div>



            <!-- ko template: {
                foreach: hrmTemplateIf(tabs.activeTab() === 0, $data),
                afterAdd: tabs.afterOpen,
                beforeRemove: hrmFadeBeforeRemoveFactory(200),
              } -->
            <div class="calculation-page__tab">
              @@include('tabs/_production.html')
            </div>
            <!-- /ko -->

            <!-- ko template: {
                foreach: hrmTemplateIf(tabs.activeTab() === 1, $data),
                afterAdd: tabs.afterOpen,
                beforeRemove: hrmFadeBeforeRemoveFactory(200)
              } -->
            <div class="calculation-page__tab">
              @@include('tabs/_delivery.html')
            </div>
            <!-- /ko -->

            <!-- ko template: {
                foreach: hrmTemplateIf(tabs.activeTab() === 2, $data),
                afterAdd: hrmFadeAfterAddFactory(200, 200),
                beforeRemove: hrmFadeBeforeRemoveFactory(200)
              } -->
            <div class="calculation-page__tab">
              @@include('tabs/_lateness.html')
            </div>
            <!-- /ko -->
            <!-- /Tabs -->

            <div class="calculation-form__actions">
              <button class="hrm-button hrm-button--size_large hrm-basic-button calculation-form__action"
                      data-bind="click: reset, disable: blockResetButton">
                Отменить
              </button>

              <button class="hrm-button hrm-button--size_large hrm-basic-button hrm-accent-button calculation-form__action"
                      data-bind="click: $root.submit.bind($root, null), disable: blockSaveButton">
                Сохранить

                <!-- ko template: {
                  foreach: hrmTemplateIf(showSuccessMessage(), $data),
                  afterAdd: hrmFadeAfterAddFactory(200),
                  beforeRemove: hrmFadeBeforeRemoveFactory(200)
                } -->
                <div class="message message--success">
                  <i class="far fa-check"></i>
                  Расчет успешно сохранен
                </div>
                <!-- /ko -->

                <!-- ko template: {
                  foreach: hrmTemplateIf(showErrorMessage(), $data),
                  afterAdd: hrmFadeAfterAddFactory(200),
                  beforeRemove: hrmFadeBeforeRemoveFactory(200)
                } -->
                <div class="message message--error">
                  <i class="far fa-exclamation-circle"></i>
                  Произошла ошибка при сохранении
                </div>
                <!-- /ko -->
              </button>

              <button class="hrm-button hrm-button--size_large hrm-basic-button hrm-accent-button calculation-form__action"
                      data-bind="click: $root.submit.bind($root, true), disable: blockSaveButton">
                Сохранить c ошибкой

                <!-- ko template: {
                  foreach: hrmTemplateIf(showErrorMessage(), $data),
                  afterAdd: hrmFadeAfterAddFactory(200),
                  beforeRemove: hrmFadeBeforeRemoveFactory(200)
                } -->
                <div class="message message--error">
                  <i class="far fa-exclamation-circle"></i>
                  Произошла ошибка при сохранении
                </div>
                <!-- /ko -->
              </button>
            </div>
          </div>
          <!-- /ko -->
        </div>
      </div>
      <!-- /Page content  -->



    </div>

    @@include('components/_modals.html')
  </div>

  <script id="versions-dropdown-template"
          type="text/html">
        <!-- ko foreach: $root.versions -->
  <div class="hrm-dropdown-menu__item">
    <a class="version-preview" data-bind="attr: {href: $data.link}">
      <div class="version-preview__userpic">
        <img data-bind="attr: {src: $data.avatar}"
             alt="">
      </div>
      <div class="version-preview__content">
        <div class="version-preview__user"
             data-bind="text: $data.name"></div>
        <div class="version-preview__time"
             data-bind="text: $data.time"></div>
      </div>
    </a>
  </div>
  <!-- /ko -->
  </script>

  <script id="actions-dropdown-template"
          type="text/html">

        <div class="hrm-dropdown-menu__item">
          <a class="action-preview" href="#">
            <svg width="14" height="14">
              <use href="#excel-icon"></use>
            </svg>
            Выгрузить в Excel
          </a>
        </div>
        <div class="hrm-dropdown-menu__item">
          <a class="action-preview" href="#">
            <svg width="14" height="14">
              <use href="#print-icon"></use>
            </svg>
            Распечатать
          </a>
        </div>
        <div class="hrm-dropdown-menu__item">
          <a class="action-preview" href="#">
            <svg width="14" height="14">
              <use href="#picture-icon"></use>
            </svg>
            Для фото
          </a>

        </div>
        <div class="hrm-dropdown-menu__item">
          <a class="action-preview" href="#">
            <svg width="14" height="16">
              <use href="#calculation-icon"></use>
            </svg>
            Новый расчет
          </a>
        </div>
  </script>

  @@include('../../base/_page-scripts.html')

  @@include('../../modals/confirm-modal/_confirm-modal.js.html')
  @@include('../../modals/columns-settings-modal/_columns-settings-modal.js.html')
  @@include('../../modals/positions-settings-modal/_positions-settings-modal.js.html')
  @@include('../../modals/account-operations-modal/_account-operations-modal.js.html')
  @@include('../../modals/employee-fine-modal/_employee-fine-modal.js.html')
  @@include('../../modals/employee-bonus-modal/_employee-bonus-modal.js.html')
  @@include('../../modals/create-employee-modal/_create-employee-modal.js.html')
  @@include('../../modals/add-employees-modal/_add-employees-modal.js.html')
  @@include('../../modals/stimulation-modal/_stimulation-modal.js.html')

  @@include('./components/compensations-modal/_compensations-modal.js.html')
  @@include('./components/routes-modal/_routes-modal.js.html')
  @@include('./components/details-modal/_driver-details-modal.js.html')
  @@include('./components/details-modal/_lateness-details-modal.js.html')

  @@include('./components/input-form/_input-form.js.html')
  @@include('./components/summary-table/_summary-table.js.html')
  @@include('./components/positions-table/_positions-table.js.html')
  @@include('./components/delivery-table/_delivery-table.js.html')
  @@include('./_new-calculation-page.js.html')
</body>

</html>
